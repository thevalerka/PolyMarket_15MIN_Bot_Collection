from web3 import Web3, Account
import json
import time
from time import sleep

# Connect to Ethereum node
infura_url = "https://polygon-mainnet.core.chainstack.com/d308330baf4e49cfc74c637905858979"
web3 = Web3(Web3.HTTPProvider(infura_url))

if not web3.is_connected():
    print("Failed to connect to Ethereum network")
    exit()

# Contract address and ABI
nft_contract_address = "0x4D97DCd97eC945f40cF65F87097ACe5EA0476045"

# Load ABI from file
with open('abi.json', 'r') as f:
    abi = json.load(f)

erc1155_abi = abi  # Replace with the ERC-1155 ABI

# Create contract instance
nft_contract = web3.eth.contract(address=nft_contract_address, abi=erc1155_abi)

# Wallet details
sender_private_key = "YOUR_PRIVATE_KEY"
sender_account = Account.from_key(sender_private_key)
sender_address = sender_account.address

# Recipient address, token ID, and amount
recipient_address = "0x04BFC6Af9Cb9E44a230D5B83f2D02e4D58f686B8"
#token_id = 77853863740267673465985559580471336530361057088005942563498223582902789958405  # Replace with the token ID you want to transfer
amount = 10000000  # Number of tokens to transfer (for NFTs, this is usually 1)

token_list = [
60698420810648376094970669064182158158730985321981847281169320203775633359235,
50294342906437324980993018115617966598985302189750051427290713943338543498001,
76791487060772517064598157388621102364535287212280885844224963606322390922329,
98200228109493157387378569515265920879325889621392268856122746185965939918044,
96880374172866557292379003325550396838000667838524487565312337543790767702097,
60698420810648376094970669064182158158730985321981847281169320203775633359235,
50294342906437324980993018115617966598985302189750051427290713943338543498001,
76791487060772517064598157388621102364535287212280885844224963606322390922329,
98200228109493157387378569515265920879325889621392268856122746185965939918044,
96880374172866557292379003325550396838000667838524487565312337543790767702097
# 105616029188759702618050614944523521285086165709572926176895550634544548927297,
# 44095882196379202274742211181660292816664849605155462607464051382667230667105,
#93547734182907731472720526896584944324679806688456258432952832517057845117441,

# 35109471635680047055404002837886303762015059585568819645458759388354016677111,
#
# 100338363448574929396092995229667261425485404042548667367590674049793284915522,

#
# 110741509552146476861542889384135977408915521510190228566081539837184138645133,
#
# 101280978557669322311839482014722200240466628184400492198983183940038298230654,
# 25510699387426106536268213735935449752268735473977116699555281277979973017352,
# 115483963873950346000861456584700766034384471182802251771833501986118535630898,
# 61221151356928143694922593202914225080892014431945172280632170403965775004202,
# 20279515716365724877422115962181852650187160527420051958682514098307018397358,
#
# 108641193296702513434720703302963273439658833764120260839617002134764779550980,
# 72315296960157853267825015401797326814581833027692157374365809904260949998361,
# 73230439847275372773745266917040102134172972040547233155447454996800051156851,
# 114325660893797914957825038354136309372549635019650903408866481482781962221976,
# 92571186889772149516173471408418702715839160469414043958171791062083297820126,
# 80210547224522677018665816646794558187477186574947196112084214730138012257347,
# 59402279261164585519254607550710686667071190597138451050588782764969738175726,
# 38836924991509883291309790046897283428703023282143715237391341961839556006554,
# 76101757506833494451423160241746847826107678159203527393096091575731975285345,
# 25998417805019380256913766978055787001372597802944751840838737339407929210302


]


token_dict =  {
110741509552146476861542889384135977408915521510190228566081539837184138645133,





}


# 10000000 = 10

for token_id in token_list :

    try :

        # Build the transaction
        transaction = nft_contract.functions.safeTransferFrom(
            sender_address,
            recipient_address,
            token_id,
            1468000,#0.8shares
            #10000000, #18 shares

            b''  # Additional data (optional)
        ).build_transaction({
            'chainId': 137,  # Mainnet
            'gas': 200000,  # Adjust gas limit as needed
            'gasPrice': web3.to_wei('50', 'gwei'),  # Adjust gas price as needed
            'nonce': web3.eth.get_transaction_count(sender_address),
        })

        # Sign the transaction
        signed_txn = web3.eth.account.sign_transaction(transaction, private_key=sender_private_key)

        # Send the transaction
        txn_hash = web3.eth.send_raw_transaction(signed_txn.raw_transaction)

        # Wait for the transaction to be mined
        txn_receipt = web3.eth.wait_for_transaction_receipt(txn_hash)
        print(f"Transaction successful with hash: {txn_hash.hex()}")
        sleep(3)

    except Exception as e :
        print(e)
